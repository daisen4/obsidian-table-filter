# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæŒ¯ã‚Šè¿”ã‚Š: obsidian-table-filter

**æœŸé–“**: 2026å¹´2æœˆ
**æˆæžœç‰©**: Obsidian ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ â€” Markdownãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½

---

## 1. é€²ã‚æ–¹ã®æŒ¯ã‚Šè¿”ã‚Š

### âœ… ã†ã¾ãã„ã£ãŸã“ã¨

- **åˆæœŸæ§‹ç¯‰ã¯ä¸€ç™º**: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®é››å½¢ï¼ˆmanifest.json / package.json / tsconfig.json / esbuild.config.mjs / main.ts / styles.cssï¼‰ã‚’ã¾ã¨ã‚ã¦ç”Ÿæˆã—ã€ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ã¾ã§ä¸€æ°—ã«é€šã›ãŸ
- **ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã«ã‚ˆã‚‹ãƒ‡ãƒ—ãƒ­ã‚¤**: Vault ã¸ã®ãƒªãƒ³ã‚¯æ–¹å¼ã‚’æŽ¡ç”¨ã—ãŸã“ã¨ã§ã€ãƒ“ãƒ«ãƒ‰å¾Œã®æ‰‹å‹•ã‚³ãƒ”ãƒ¼ãŒä¸è¦ã«ãªã‚Šã€é–‹ç™ºã‚µã‚¤ã‚¯ãƒ«ãŒé€Ÿã‹ã£ãŸ
- **æ©Ÿèƒ½è¿½åŠ ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæ˜Žç¢º**: ã€Œãƒ˜ãƒƒãƒ€ãƒ¼å›ºå®šã€ã€Œç·¨é›†ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œã€ã€ŒExcelãƒ©ã‚¤ã‚¯ãªåˆ—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã€ã¨æ®µéšŽçš„ã«è¦ä»¶ãŒå‡ºã¦ããŸãŸã‚ã€ä¸€ã¤ãšã¤å¯¾å¿œã—ã‚„ã™ã‹ã£ãŸ

### âš ï¸ è©°ã¾ã£ãŸç®‡æ‰€ãƒ»æ‰‹æˆ»ã‚ŠãŒå¤šã‹ã£ãŸç®‡æ‰€

- **ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã®ãƒ˜ãƒƒãƒ€ãƒ¼å›ºå®š**: æœ€ã‚‚è©¦è¡ŒéŒ¯èª¤ãŒå¤šã‹ã£ãŸç®‡æ‰€ã€‚ä»¥ä¸‹ã®é †ã§å¤±æ•—ã‚’é‡ã­ãŸï¼š
  1. CSS sticky â†’ CodeMirrorã® `overflow: hidden` ã«é˜»ã¾ã‚Œã¦åŠ¹ã‹ãªã„
  2. JS translateY â†’ èƒŒæ™¯ãŒé€æ˜Žã«ãªã£ã¦ã—ã¾ã†
  3. `position: absolute` ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ â†’ ç¥–å…ˆè¦ç´ ã® `overflow: hidden` ã§ã‚¯ãƒªãƒƒãƒ—ã•ã‚Œã‚‹
  4. `position: fixed` + `document.body` â†’ **æœ€çµ‚çš„ã«è§£æ±º**

  **åçœ**: CodeMirrorã®DOMæ§‹é€ ï¼ˆ`overflow: hidden` ãŒé‡ãªã£ã¦ã„ã‚‹ï¼‰ã‚’æœ€åˆã«èª¿æŸ»ã—ã¦ã‹ã‚‰å®Ÿè£…ã™ã‚Œã°ã€ç„¡é§„ãªè©¦è¡Œã‚’æ¸›ã‚‰ã›ãŸå¯èƒ½æ€§ãŒã‚ã‚‹

- **èƒŒæ™¯è‰²ã®é€æ˜Žå•é¡Œ**: `getComputedStyle` ã§CSSã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆ`var(--background-primary)`ï¼‰ãŒè§£æ±ºã§ããšã€ãƒ—ãƒ­ãƒ¼ãƒ–è¦ç´ ã‚’ä½¿ã†è¿‚å›žç­–ãŒå¿…è¦ã ã£ãŸã€‚Obsidianã®ãƒ†ãƒ¼ãƒžå¤‰æ•°ã®æŒ™å‹•ã‚’äº‹å‰ã«æŠŠæ¡ã—ã¦ã„ã‚Œã°ã‚ˆã‚Šé€Ÿãè§£æ±ºã§ããŸ

- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®ç¢ºèªãŒé…ã‚ŒãŸ**: DevToolsã§ã®ç¢ºèªã‚’ä¾é ¼ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒé…ãã€ã€ŒèƒŒæ™¯è‰²ã¯ã™ã§ã«æ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ãŸãŒæç”»é †åºã®å•é¡Œã ã£ãŸã€ã¨åˆ¤æ˜Žã™ã‚‹ã¾ã§ã«è¤‡æ•°å›žã®è©¦è¡ŒãŒç™ºç”Ÿã—ãŸ

### ðŸ“Œ æ¬¡å›žã«æ´»ã‹ã™ã“ã¨

- Obsidian/CodeMirrorã®DOMæ§‹é€ ã®åˆ¶ç´„ï¼ˆoverflowã€stacking contextï¼‰ã¯æœ€åˆã«èª¿ã¹ã‚‹
- ã€Œå‹•ã„ã¦ã„ãªã„ã€ã¨è¨€ã‚ã‚ŒãŸã‚‰ã€DevToolsã«ã‚ˆã‚‹å®Ÿæ…‹ç¢ºèªã‚’æ—©ã‚ã«ä¾é ¼ã™ã‚‹
- æ®µéšŽçš„ãªæ©Ÿèƒ½è¿½åŠ ã¯ä»Šå›žã†ã¾ãæ©Ÿèƒ½ã—ãŸã€‚å¼•ãç¶šãã€Œå°ã•ãå‹•ã‹ã—ã¦ç¢ºèªã€ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’ç¶­æŒã™ã‚‹

---

## 2. è¨­è¨ˆãƒ»å®Ÿè£…ã®æŒ¯ã‚Šè¿”ã‚Š

### âœ… è¨­è¨ˆã®è‰¯ã‹ã£ãŸç‚¹

- **é–²è¦§ãƒ¢ãƒ¼ãƒ‰ã¨ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã®åˆ†é›¢**: ãã‚Œãžã‚Œ `addFilterToTable` / `addFilterToTableEditor` ã¨ã—ã¦å®Ÿè£…ã‚’åˆ†ã‘ãŸã“ã¨ã§ã€ä¸€æ–¹ã®å¤‰æ›´ãŒä»–æ–¹ã«å½±éŸ¿ã—ãªã‹ã£ãŸ

- **`position: fixed` + `document.body` ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤**: CodeMirrorã®åˆ¶ç´„ã‚’æ ¹æœ¬ã‹ã‚‰å›žé¿ã™ã‚‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€‚MutationObserverãƒ»ResizeObserverã§å…ƒã®theadã¨åŒæœŸã•ã›ã‚‹è¨­è¨ˆã¯å …ç‰¢ã ã£ãŸ

- **ãƒ—ãƒ­ãƒ¼ãƒ–è¦ç´ ã«ã‚ˆã‚‹èƒŒæ™¯è‰²è§£æ±º**: `var(--background-primary)` ãªã©ã®CSSã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å®Ÿéš›ã®RGBå€¤ã«è§£æ±ºã™ã‚‹ãŸã‚ã€ä¸€æ™‚çš„ãª`div`è¦ç´ ã‚’bodyã«æŒ¿å…¥ã—ã¦`getComputedStyle`ã§èª­ã¿å–ã‚‹æ‰‹æ³•ã€‚å†åˆ©ç”¨æ€§ãŒé«˜ã„

- **æ•°å€¤åˆ—ã®è‡ªå‹•åˆ¤å®š**: `isNumericColumn` ã§å…¨ã‚»ãƒ«ãŒæ•°å€¤ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€åˆ—ã‚¿ã‚¤ãƒ—ã‚’å‹•çš„ã«æ±ºå®šã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¨­å®šä¸è¦ãªç‚¹ãŒä½¿ã„ã‚„ã™ã„

- **AND ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¨­è¨ˆ**: `filters` é…åˆ—ã‚’åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ç®¡ç†ã—ã€`applyFilters` ã§å…¨æ¡ä»¶ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹è¨­è¨ˆãŒã‚·ãƒ³ãƒ—ãƒ«ã‹ã¤æ‹¡å¼µã—ã‚„ã™ã„

### âš ï¸ è¨­è¨ˆã®æ”¹å–„ç‚¹

- **ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã®thå†ç”Ÿæˆ**: ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã§ `buildOverlay` ãŒå‘¼ã°ã‚Œã‚‹ãŸã³ã« `attachColumnFilter` ãŒå†å®Ÿè¡Œã•ã‚Œã‚‹ï¼ˆ`if (th.querySelector(".tf-btn")) return` ã§ã‚¬ãƒ¼ãƒ‰ã¯ã—ã¦ã„ã‚‹ãŒã€DOMã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ãŒé‡è¤‡ç™»éŒ²ã•ã‚Œã‚‹ãƒªã‚¹ã‚¯ãŒæ®‹ã‚‹ï¼‰

- **`document.addEventListener("click")` ã®å¤šé‡ç™»éŒ²**: åˆ—ã®æ•°ã ã‘ãƒ‘ãƒãƒ«ã‚’é–‰ã˜ã‚‹ click ãƒªã‚¹ãƒŠãƒ¼ãŒ `document` ã«ç™»éŒ²ã•ã‚Œã‚‹ã€‚`AbortController` ã‚„ãƒ•ãƒ©ã‚°ã§ä¸€å…ƒç®¡ç†ã™ã¹ãã ã£ãŸ

- **ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒªã‚»ãƒƒãƒˆæ‰‹æ®µãŒãªã„**: ç¾çŠ¶ã€ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã‚’æ‰‹å‹•ã§æ¶ˆã™ã—ã‹ãªãã€ã€Œå…¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ã‚¯ãƒªã‚¢ã€ãƒœã‚¿ãƒ³ãŒã‚ã‚‹ã¨ä½¿ã„ã‚„ã™ã„

- **ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã§ã®åˆ—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼çŠ¶æ…‹ã®æ°¸ç¶šæ€§**: CodeMirrorãŒtheadã‚’å†æç”»ã™ã‚‹ã¨ `buildOverlay` ãŒèµ°ã‚Šã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å…¥åŠ›å€¤ãŒUIã‹ã‚‰ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ï¼ˆ`filters` é…åˆ—ã®å€¤ã¯æ®‹ã‚‹ãŒè¦‹ãŸç›®ãŒãƒªã‚»ãƒƒãƒˆï¼‰

### ðŸ”§ æŠ€è¡“çš„ã«å­¦ã‚“ã ã“ã¨

| å•é¡Œ | åŽŸå›  | è§£æ±ºç­– |
|------|------|--------|
| CSS sticky ãŒåŠ¹ã‹ãªã„ | ç¥–å…ˆã« `overflow: hidden` | `position: fixed` + `document.body` |
| `border-collapse: collapse` ã§stickyãŒå‹•ã‹ãªã„ | CSSä»•æ§˜ | `border-collapse: separate !important` |
| CSSã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒè§£æ±ºã§ããªã„ | DOMæœªæŽ¥ç¶šæ™‚ã®åˆ¶é™ | ãƒ—ãƒ­ãƒ¼ãƒ–è¦ç´ ã‚’bodyã«æŒ¿å…¥ã—ã¦èª­ã¿å–ã‚‹ |
| tbodyãŒtheadã®ä¸Šã«æç”»ã•ã‚Œã‚‹ | CSSãƒ†ãƒ¼ãƒ–ãƒ«æç”»é †åº | z-index/transformã¯ç„¡åŠ¹ã€fixed overlayã§å¯¾å¿œ |

---

## æœ€çµ‚çš„ãªæ©Ÿèƒ½ä¸€è¦§

| æ©Ÿèƒ½ | çŠ¶æ…‹ |
|------|------|
| é–²è¦§ãƒ¢ãƒ¼ãƒ‰: ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ | âœ… |
| é–²è¦§ãƒ¢ãƒ¼ãƒ‰: ãƒ˜ãƒƒãƒ€ãƒ¼å›ºå®š | âœ… |
| ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ (Live Preview): ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ | âœ… |
| ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ (Live Preview): ãƒ˜ãƒƒãƒ€ãƒ¼å›ºå®š | âœ… |
| åˆ—ã”ã¨ã®â–¼ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ | âœ… |
| æ•°å€¤åˆ—: æ¯”è¼ƒæ¼”ç®—å­ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆâ‰¥ â‰¤ = > <ï¼‰ | âœ… |
| æ•°å€¤åˆ—ã®è‡ªå‹•åˆ¤å®š | âœ… |
| è¤‡æ•°åˆ—ã®ANDãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ | âœ… |
